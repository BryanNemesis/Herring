(this["webpackJsonpherring-web"]=this["webpackJsonpherring-web"]||[]).push([[0],{13:function(e,t,n){},15:function(e,t,n){"use strict";n.r(t);var c=n(1),a=n.n(c),r=n(6),i=n.n(r),s=(n(13),n(2)),l=n(4);var o=function(e,t,n,c){var a;c&&(a=JSON.stringify(c));var r=new XMLHttpRequest,i="http://localhost:8000/api".concat(t);r.responseType="json",r.open(e,i),r.setRequestHeader("Content-Type","application/json"),r.onload=function(){n(r.response,r.status)},r.onerror=function(e){n({message:"Request failed"},400)},r.send(a)};function u(e,t){var n="/fillets";e&&(n+="/?username=".concat(e)),o("GET",n,t)}var d=n(8),b=n(0);var f=function(e){var t=e.fillet,n=e.action,c=e.handlePerformAction,a=e.theme,r=t.like_count?t.like_count:0,i="btn btn-outline-primary btn-sm ".concat(a),s="like"===n.type?"".concat(r," ").concat(n.display):n.display,l=function(e,t){200!==t&&201!==t||!c||c(e,t)};return Object(b.jsx)("button",{className:i,onClick:function(e){e.preventDefault(),function(e,t,n){o("POST","/fillets/action/",n,{id:e,action:t})}(t.id,n.type,l)},children:s})};var j=function e(t){var n=t.fillet,a=t.handleRepost,r=n.text?n.text:"reposted",i=n.is_repost?"px-3 text-muted small":"px-3",l=Object(c.useState)(n||null),o=Object(s.a)(l,2),u=o[0],j=o[1],m=window.location.pathname.match(Object(d.a)(/([0-9]+)/,{filletId:1})),p=m?m.groups.filletId:0,h="".concat(p)==="".concat(n.id),O=function(e,t){200===t?j(e):201===t&&a(e)};return Object(b.jsxs)("div",{className:"col-12 col-md-10 mx-auto border rounded py-2 mb-4",children:[Object(b.jsxs)("div",{children:[Object(b.jsxs)("p",{className:i,children:[Object(b.jsxs)("i",{children:[n.id,":"]})," ",r]}),n.is_repost&&Object(b.jsx)("div",{className:"col-9",children:Object(b.jsx)(e,{fillet:u.parent,handleRepost:a})})]}),u&&Object(b.jsxs)("div",{className:"btn btn-group",children:[Object(b.jsx)(f,{fillet:u,action:{type:"like",display:"Likes"},handlePerformAction:O,theme:"btn-dark"}),Object(b.jsx)(f,{fillet:u,action:{type:"unlike",display:"Unlike"},handlePerformAction:O,theme:"btn-dark"}),Object(b.jsx)(f,{fillet:u,action:{type:"repost",display:"Repost"},handlePerformAction:O,theme:"btn-light"}),!h&&Object(b.jsx)("button",{onClick:function(e){e.preventDefault(),window.location.href="/".concat(n.id)},className:"btn btn-outline-primary btn-sm btn-light",children:"View"})]})]})};var m=function(e){var t=e.newFillets,n=e.setNewFillets,a=e.username,r=Object(c.useState)([]),i=Object(s.a)(r,2),o=i[0],d=i[1],f=Object(c.useState)(t||[]),m=Object(s.a)(f,2),p=m[0],h=m[1],O=Object(c.useState)(!1),v=Object(s.a)(O,2),x=v[0],y=v[1];Object(c.useEffect)((function(){var e=Object(l.a)(t).concat(p);e.length!==o.length&&d(e)}),[o,t,p]),Object(c.useEffect)((function(){if(!x){u(a,(function(e,t){200===t?(h(e),y(!0)):alert("You have error :-D")}))}}),[p,x,a]);var g=function(e){var c=Object(l.a)(t);c.unshift(e),n(c)};return Object(b.jsx)("div",{children:o.map((function(e){return Object(b.jsx)(j,{fillet:e,handleRepost:g},e.id)}))})};var p=function(e){var t=e.newFillets,n=e.setNewFillets,c=a.a.createRef(),r=function(e,c){if(console.log(e,c),201===c){var a=Object(l.a)(t);a.unshift(e),n(a)}else alert("you have error :-D")};return Object(b.jsxs)("form",{onSubmit:function(e){e.preventDefault();var t=c.current.value;c.current.value="",o("POST","/fillets/create/",r,{text:t})},children:[Object(b.jsx)("textarea",{className:"form-control",required:!0,ref:c}),Object(b.jsx)("button",{type:"submit",className:"btn btn-outline-primary btn-sm my-3 btn-dark",children:"Post"})]})};function h(e){var t=e.username,n=e.userCanPost,a=Object(c.useState)([]),r=Object(s.a)(a,2),i=r[0],l=r[1];return n="true"===n,Object(b.jsxs)("div",{className:"col-12 mb-3",children:[n&&Object(b.jsx)(p,{newFillets:i,setNewFillets:l}),Object(b.jsx)(m,{newFillets:i,setNewFillets:l,username:t})]})}function O(e){var t=e.filletId,n=Object(c.useState)(!1),a=Object(s.a)(n,2),r=a[0],i=a[1],l=Object(c.useState)(null),u=Object(s.a)(l,2),d=u[0],f=u[1],m=function(e,t){200===t?f(e):alert("Error: could not find fillet.")};return Object(c.useEffect)((function(){!1===r&&(!function(e,t){o("GET","/fillets/".concat(e,"/"),t)}(t,m),i(!0))}),[r,i,t]),null===d?null:Object(b.jsx)(j,{fillet:d,handleRepost:function(){}})}var v=n.p+"static/media/Logo.efa2b0d2.png";var x=function(e){var t=e.username,n=e.userCanPost;return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("div",{className:"d-flex justify-content-center py-4",children:Object(b.jsx)("img",{src:v,width:"180",height:"60",alt:""})}),Object(b.jsx)(h,{username:t,userCanPost:n})]})},y=a.a.createElement,g=document.getElementById("root");g&&i.a.render(y(x,g.dataset),g);var w=document.getElementById("Herring");w&&i.a.render(y(h,w.dataset),w),document.querySelectorAll(".herring-detail").forEach((function(e){i.a.render(y(O,e.dataset),e)}))}},[[15,1,2]]]);
//# sourceMappingURL=main.34eaa3e6.chunk.js.map